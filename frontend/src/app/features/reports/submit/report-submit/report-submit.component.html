<section class="reports-wrapper">
  <div class="reports-card">
    <header class="reports-head">
      <h3 class="reports-title">{{ 'reports.submit.title' | translate }}</h3>
    </header>

    <form class="space-y-4" (ngSubmit)="submitReport()" #form="ngForm">
      <ng-container *ngIf="!programId">
        <mat-form-field appearance="fill" class="w-full">
          <mat-label>{{ 'reports.submit.program' | translate }}</mat-label>
          <mat-select [(ngModel)]="selectedProgramId" name="program" required>
            <mat-option *ngFor="let p of programs()" [value]="p.id">{{ p.title }}</mat-option>
          </mat-select>
        </mat-form-field>
      </ng-container>

      <mat-form-field appearance="fill" class="w-full">
        <mat-label>{{ 'reports.submit.severity' | translate }}</mat-label>
        <mat-select [(ngModel)]="severity" name="severity" required>
          <mat-option value="LOW">{{ 'reports.severity.low' | translate }}</mat-option>
          <mat-option value="MEDIUM">{{ 'reports.severity.medium' | translate }}</mat-option>
          <mat-option value="HIGH">{{ 'reports.severity.high' | translate }}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill" class="w-full">
        <mat-label>{{ 'reports.submit.description' | translate }}</mat-label>
        <textarea matInput rows="5" [(ngModel)]="title" name="title" required></textarea>
      </mat-form-field>

      <div class="file-field">
        <label class="file-label">{{ 'reports.submit.file' | translate }}</label>
        <input type="file" accept="application/pdf" (change)="onFileSelected($event)" />
        <small class="text-gray-500">{{ 'reports.submit.hint' | translate }}</small>
      </div>

      <div class="form-actions">
        <button mat-raised-button color="primary" class="btn-primary"
                type="submit" [disabled]="!selectedProgramId || !title.trim() || !selectedFile">
          {{ 'reports.actions.send' | translate }}
        </button>
      </div>
    </form>
  </div>
</section>
