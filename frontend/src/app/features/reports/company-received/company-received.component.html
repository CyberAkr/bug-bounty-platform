<div class="cr-wrap">
  <header class="cr-head">
    <h1>üì• Rapports re√ßus</h1>
    <button class="cr-refresh" (click)="refresh()">‚Üª</button>
  </header>

  <div *ngIf="loading()" class="cr-state">Chargement‚Ä¶</div>
  <div *ngIf="!loading() && error()" class="cr-error">{{ error() }}</div>

  <div *ngIf="!loading() && !error() && reports().length === 0" class="cr-empty">
    Aucun rapport re√ßu pour le moment.
  </div>

  <ul *ngIf="!loading() && !error() && reports().length > 0" class="cr-list">
    <li *ngFor="let r of reports(); trackBy: trackById" class="cr-item">
      <div class="cr-item-top">
        <div class="cr-title">{{ r.title }}</div>
        <span class="cr-status"
              [style.borderColor]="(r.status | statusColor)"
              [style.color]="(r.status | statusColor)">
          {{ r.status }}
        </span>
      </div>

      <div class="cr-meta">
        <span class="cr-meta-row">
          <span class="cr-label">Programme :</span>
          <span class="cr-link">{{ r.programTitle }}</span>
        </span>

        <span class="cr-meta-row" *ngIf="r.severity">
          <span class="cr-label">S√©v√©rit√© :</span>
          <strong>{{ r.severity }}</strong>
        </span>

        <span class="cr-meta-row">
          <span class="cr-label">Re√ßu le :</span>
          <span>{{ r.submittedAt | dateFormat }}</span>
        </span>

        <span class="cr-meta-row" *ngIf="r.researcher">
          <span class="cr-label">Chercheur :</span>
          <span>{{ r.researcher }}</span>
        </span>
      </div>
      <div class="cr-actions">
        <button class="cr-download"
                [disabled]="r.status !== 'APPROVED'"
                (click)="download(r)">
          T√©l√©charger le PDF
        </button>
      </div>

      <div class="cr-actions">
        <!-- Pas de lien programme car pas de programId dans le mod√®le -->
      </div>
    </li>
  </ul>
</div>
