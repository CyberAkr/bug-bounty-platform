<div class="auth-wrapper">
  <div class="auth-card mx-auto">
    <div class="text-center mb-6">
      <span class="material-icons text-[var(--accent)] text-4xl mb-2">mark_email_unread</span>
      <h2 class="text-xl font-semibold">{{ 'verify.title' | translate }}</h2>
      <p class="text-sm opacity-80">
        {{ 'verify.subtitle' | translate:{ email: email() } }}
      </p>
    </div>

    <form (ngSubmit)="onSubmit()" class="space-y-4">
      <!-- Champ code -->
      <mat-form-field appearance="fill" class="w-full">
        <mat-label>{{ 'verify.codeLabel' | translate }}</mat-label>
        <mat-icon matPrefix>pin</mat-icon>
        <input
          matInput
          name="code"
          [ngModel]="code()" (ngModelChange)="code.set($event)"
          required inputmode="numeric" pattern="\\d{6}" maxlength="6"
          placeholder="••••••"
        />
      </mat-form-field>

      <p class="text-xs opacity-80">
        {{ 'verify.help' | translate }}
      </p>

      <!-- Boutons -->
      <div class="form-actions">
        <button
          type="button"
          class="btn-ghost flex items-center gap-1"
          (click)="onResend()"
          [disabled]="loading() || cooldown() > 0"
        >
          <mat-icon>refresh</mat-icon>
          <ng-container *ngIf="cooldown() === 0; else wait">
            {{ 'verify.resend' | translate }}
          </ng-container>
          <ng-template #wait>
            {{ 'verify.resendIn' | translate:{ seconds: cooldown() } }}
          </ng-template>
        </button>

        <button
          mat-flat-button
          color="primary"
          class="btn-primary flex items-center gap-2"
          type="submit"
          [disabled]="loading()"
        >
          <mat-icon *ngIf="loading()" class="animate-spin">hourglass_top</mat-icon>
          {{ loading() ? ('verify.loading' | translate) : ('verify.submit' | translate) }}
        </button>
      </div>
    </form>

    <p class="error-text text-center mt-4" *ngIf="error()">{{ error() | translate }}</p>
    <p class="success-text text-center mt-2" *ngIf="success()">{{ success() | translate }}</p>

    <div class="mt-6 text-center text-sm">
      <a routerLink="/login" class="text-[var(--accent)] font-medium hover:underline">
        {{ 'verify.backToLogin' | translate }}
      </a>
    </div>
  </div>
</div>
