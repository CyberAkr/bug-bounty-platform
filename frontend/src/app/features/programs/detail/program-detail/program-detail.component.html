<div class="auth-wrapper">
  <div class="auth-card w-full max-w-4xl">

    <!-- En-tête -->
    <header class="flex items-center justify-between mb-6">
      <div>
        <h2 class="text-2xl font-semibold">{{ 'programs.detail.title' | translate }}</h2>
        <p class="text-sm text-gray-600">{{ 'programs.detail.subtitle' | translate }}</p>
      </div>

      <a routerLink="/programs" mat-stroked-button class="btn-ghost">
        <mat-icon class="mr-2">arrow_back</mat-icon>
        {{ 'programs.detail.back' | translate }}
      </a>
    </header>

    <!-- Chargement -->
    <div *ngIf="loading(); else content" class="flex justify-center py-10">
      <mat-progress-spinner mode="indeterminate" diameter="40"></mat-progress-spinner>
    </div>

    <!-- Contenu principal -->
    <ng-template #content>
      <div *ngIf="program; else errorTpl">
        <!-- Bulle état du rapport -->
        <app-report-status [programId]="getId()" class="mb-6 block"></app-report-status>

        <h3 class="text-xl font-semibold mb-2">{{ program.title }}</h3>

        <div class="text-sm text-gray-500 mb-4">
          <strong>{{ 'programs.detail.company' | translate }} :</strong> {{ program.companyName }} <br />
          <strong>{{ 'programs.detail.status' | translate }} :</strong>
          <mat-chip [ngClass]="program.status | statusColor" class="status-chip">
            {{ program.status }}
          </mat-chip>
        </div>

        <!-- Description HTML -->
        <div class="prose max-w-none bg-white rounded-xl p-5 border"
             [innerHTML]="safeDescription()"></div>

        <!-- Soumission de rapport -->
        <section class="mt-8">
          <h4 class="text-lg font-medium mb-3">{{ 'programs.detail.submitTitle' | translate }}</h4>
          <app-report-submit [programId]="getId()"></app-report-submit>
        </section>
      </div>

      <ng-template #errorTpl>
        <div class="text-center text-red-600 py-8">
          {{ error() || ('programs.detail.notFound' | translate) }}
        </div>
      </ng-template>
    </ng-template>

  </div>
</div>
